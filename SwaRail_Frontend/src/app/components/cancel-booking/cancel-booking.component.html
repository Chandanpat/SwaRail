<div class="container mt-4 cancel-container">
  <h2 class="text-center text-danger fw-bold">
    <i class="fas fa-times-circle"></i> Cancel Booking
  </h2>

  <div *ngIf="ticket" class="ticket-container shadow-lg p-4 rounded">

    <h4 class="text-center text-danger fw-bold">
      PNR: <span class="pnr-highlight">{{ ticket.pnr }}</span>
    </h4>

    <div class="train-details">
      <p><strong>ğŸš† Train:</strong> {{ ticket.trainName }}</p>
      <p><strong>ğŸ“ Source:</strong> {{ ticket.sourceStation }}</p>
      <p><strong>ğŸ“ Destination:</strong> {{ ticket.destinationStation }}</p>
      <p><strong>ğŸ“… Journey Date:</strong> {{ ticket.journeyDate | date:'dd-MM-yyyy' }}</p>
      <p><strong>â° Departure:</strong> {{ ticket.sourceDepartureTime || 'N/A' }}</p>
      <p><strong>â³ Arrival:</strong> {{ ticket.destiArrivalTime || 'N/A' }}</p>
    </div>

    <h4 class="text-secondary mt-4"><i class="fas fa-user-minus"></i> Select Passengers to Cancel</h4>
    <hr />

    <form [formGroup]="cancelForm" (ngSubmit)="confirmCancellation()" class="fade-in">
      <div formArrayName="passengers">
        <div *ngFor="let passenger of passengers.controls; let i = index" [formGroupName]="i" class="passenger-item">
          
          <ng-container *ngIf="passenger.value.seatNo !== null; else noSeat">
            <input type="checkbox" formControlName="selected" class="form-check-input custom-checkbox">
            <label class="form-check-label">
              <strong>{{ passenger.value.passengerName }}</strong> 
              ({{ passenger.value.age }} yrs, {{ passenger.value.sex }}) -
              Coach: {{ passenger.value.coachNo }} | Seat No.: {{ passenger.value.seatNo }}
            </label>
          </ng-container>

          <ng-template #noSeat>
            <label class="form-check-label text-muted">
              <strong>{{ passenger.value.passengerName }}</strong> 
              ({{ passenger.value.age }} yrs, {{ passenger.value.sex }}) - 
              Coach: N/A | Seat No.: N/A
            </label>
          </ng-template>

        </div>
      </div>

      <button type="submit" class="btn btn-danger w-100 mt-3 confirm-btn">
        <i class="fas fa-check-circle"></i> Confirm Cancellation
      </button>
    </form>
  </div>

  <div *ngIf="!ticket" class="text-center fade-in">
    <p class="text-danger"> No ticket found.</p>
  </div>
</div>
