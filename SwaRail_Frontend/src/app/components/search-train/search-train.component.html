<div class="container search-container animate__animated animate__fadeIn">
  <div class="card shadow-lg border-0 mt-5 search-card">
    <div class="card-header bg-primary text-white text-center">
      <h3><i class="fas fa-train me-2"></i>Search Available Trains</h3>
    </div>

    <div class="card-body">
      <form [formGroup]="searchForm" (ngSubmit)="searchTrains()" class="row g-4">
        <div class="col-md-4">
          <label class="form-label fw-semibold">From Station</label>
          <select class="form-select" formControlName="sourceStation" required>
            <option value="" disabled selected>Select Source</option>
            <option *ngFor="let station of stations" [value]="station.stationName">{{ station.stationName }}</option>
          </select>
        </div>

        <div class="col-md-4">
          <label class="form-label fw-semibold">To Station</label>
          <select class="form-select" formControlName="destinationStation" required>
            <option value="" disabled selected>Select Destination</option>
            <option *ngFor="let station of stations" [value]="station.stationName">{{ station.stationName }}</option>
          </select>
        </div>

        <div class="col-md-3">
          <label class="form-label fw-semibold">Journey Date</label>
          <input type="date" class="form-control" formControlName="journeyDate" required />
        </div>

        <div class="col-md-2 d-grid">
          <button type="submit" class="btn btn-primary w-100" [disabled]="searchForm.invalid">
            <i class="fas fa-search me-1"></i> Search
          </button>
        </div>
        
      </form>
    </div>
  </div>

  <div *ngIf="trains.length > 0" class="card shadow-sm mt-4 animate__animated animate__fadeInUp">
    <div class="card-header bg-success text-white text-center">
      <h4><i class="fas fa-list me-2"></i>Available Trains</h4>
    </div>

    <div class="table-responsive">
      <table class="table table-bordered table-hover text-center align-middle mb-0">
        <thead class="table-primary">
          <tr>
            <th>Train</th>
            <th>Route</th>
            <th>Departure</th>
            <th>Arrival</th>
            <th>Sleeper Seats</th>
            <th>AC Seats</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let train of trains">
            <td>{{ train.trainName }}</td>
            <td>{{ train.sourceStation }} â†’ {{ train.destinationStation }}</td>
            <td>{{ train.sourceDepartureTime }}</td>
            <td>{{ train.destiArrivalTime }}</td>
            <td>{{ train.availableSleeperSeats }}</td>
            <td>{{ train.availableACSeats }}</td>
            <td>
              <button class="btn btn-outline-primary btn-sm"
                [disabled]="train.availableSleeperSeats === 0 && train.availableACSeats === 0"
                (click)="fetchScheduleAndBook(train.trainID)">
                <i class="fas fa-ticket-alt me-1"></i> Book Now
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div *ngIf="trains.length === 0 && searched" class="alert alert-warning text-center mt-4">
    <i class="fas fa-exclamation-triangle"></i> No trains found for the selected route and date.
  </div>
</div>
